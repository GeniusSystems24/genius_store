# وحدة الخدمات (Services Module)

[![English](https://img.shields.io/badge/Language-English-blueviolet?style=for-the-badge)](README.md)

يحتوي هذا الدليل على خدمات على مستوى التطبيق توفر وظائف عبر ميزات مختلفة من تطبيق متجر Genius.

## الغرض

توفر وحدة الخدمات وظائف قابلة لإعادة الاستخدام يمكن الوصول إليها في جميع أنحاء التطبيق. هذه الخدمات:

- تغلف التفاعلات مع الأنظمة الخارجية
- توفر أدوات مساعدة على مستوى التطبيق
- تدير الحالة التي يلزم الوصول إليها عبر الميزات
- تجرد الوظائف الخاصة بالمنصة

## المكونات

### خدمة Firebase

يدير ملف `firebase_service.dart` التفاعلات مع Firebase:

- يهيئ Firebase
- يوفر الوصول إلى نسخ Firebase (Firestore، Auth، Storage)
- يتعامل مع تكوين Firebase
- ينفذ طرق مساعدة للعمليات الشائعة في Firebase

### خدمة التخزين

يدير ملف `storage_service.dart` استمرارية البيانات المحلية:

- يهيئ ويوفر الوصول إلى التفضيلات المشتركة
- يتعامل مع التخزين الآمن للبيانات الحساسة
- يوفر طرق لتخزين واسترجاع البيانات المحلية
- يدير سياسات التخزين المؤقت

### خدمة التحليلات

يتتبع ملف `analytics_service.dart` سلوك المستخدم:

- يهيئ مزودي التحليلات
- يتتبع مشاهدات الشاشة
- يسجل الأحداث وإجراءات المستخدم
- يدير خصائص وسمات المستخدم

### خدمة الاتصال

يراقب ملف `connectivity_service.dart` حالة الشبكة:

- يتتبع حالة اتصال الإنترنت
- يوفر تدفق تغييرات الاتصال
- ينفذ آليات إعادة المحاولة لعمليات الشبكة
- يخزن البيانات مؤقتًا للاستخدام دون اتصال

### خدمة المصادقة

يدير ملف `auth_service.dart` مصادقة المستخدم:

- يتعامل مع تسجيل دخول المستخدم والتسجيل
- يدير حالة المصادقة
- يوفر معلومات المستخدم الحالي
- ينفذ منطق تحديث الرمز المميز

### خدمة الإشعارات

يدير ملف `notification_service.dart` إشعارات الدفع:

- يهيئ مزودي الإشعارات
- يتعامل مع أذونات الإشعارات
- يعالج الإشعارات الواردة
- يدير مواضيع الإشعارات

## الاستخدام

### حقن التبعيات (Dependency Injection)

يتم توفير الخدمات عادة من خلال مزودي Riverpod:

```dart
// تعريف المزود
final firebaseServiceProvider = Provider<FirebaseService>((ref) {
  return FirebaseService();
});

// الوصول إلى الخدمة في أداة
final firebaseService = ref.watch(firebaseServiceProvider);
```

### الاستخدام المباشر

يمكن الوصول إلى بعض الخدمات مباشرة من خلال طرق ثابتة:

```dart
// تسجيل حدث تحليلي
AnalyticsService.logEvent('product_viewed', {'product_id': 'abc123'});

// التحقق من الاتصال
final isConnected = await ConnectivityService.hasInternetConnection();
```

### تهيئة الخدمة

يتم إعداد الخدمات التي تتطلب التهيئة في طريقة main للتطبيق:

```dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  
  await FirebaseService.initialize();
  await StorageService.initialize();
  await NotificationService.initialize();
  
  runApp(const ProviderScope(child: App()));
}
```

## إنشاء خدمات جديدة

عند إنشاء خدمة جديدة:

1. حدد مسؤولية واضحة للخدمة
2. قم بإنشاء واجهة/فئة مجردة إذا كان من الممكن أن يكون لها تنفيذات متعددة
3. فكر فيما إذا كانت تحتاج إلى أن تكون قابلة للحقن أم يمكن أن تكون ثابتة
4. أضف منطق التهيئة إذا لزم الأمر
5. وثّق واجهة برمجة التطبيقات العامة بشكل شامل
