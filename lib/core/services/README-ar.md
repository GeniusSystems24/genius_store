# وحدة الخدمات

[![الإنجليزية](https://img.shields.io/badge/Language-English-blueviolet?style=for-the-badge)](README.md)

يحتوي هذا الدليل على خدمات التطبيق الشاملة التي توفر وظائف عبر مختلف ميزات تطبيق متجر جينيوس.

## الغرض

وحدة الخدمات توفر وظائف قابلة لإعادة الاستخدام يمكن الوصول إليها في جميع أنحاء التطبيق. هذه الخدمات:

- تغلف التفاعلات مع الأنظمة الخارجية
- توفر أدوات مساعدة عامة للتطبيق
- تدير الحالة التي تحتاج إلى الوصول إليها عبر الميزات
- تجرد وظائف خاصة بالمنصة

## المكونات

### خدمة Firebase

يدير ملف `firebase_service.dart` التفاعلات مع Firebase:

- تهيئة Firebase
- توفير الوصول إلى مثيلات Firebase (Firestore، Auth، Storage)
- التعامل مع تكوين Firebase
- تنفيذ طرق مساعدة لعمليات Firebase الشائعة

### خدمة التخزين

يدير ملف `storage_service.dart` استمرارية البيانات المحلية:

- تهيئة وتوفير الوصول إلى التفضيلات المشتركة
- التعامل مع التخزين الآمن للبيانات الحساسة
- توفير طرق لتخزين واسترجاع البيانات المحلية
- إدارة سياسات التخزين المؤقت

### خدمة التحليلات

يتتبع ملف `analytics_service.dart` سلوك المستخدم:

- تهيئة مزودي التحليلات
- تتبع مشاهدات الشاشة
- تسجيل الأحداث وإجراءات المستخدم
- إدارة خصائص وسمات المستخدم

### خدمة الاتصال

يراقب ملف `connectivity_service.dart` حالة الشبكة:

- تتبع حالة اتصال الإنترنت
- توفير تدفق لتغييرات الاتصال
- تنفيذ آليات إعادة المحاولة لعمليات الشبكة
- تخزين البيانات مؤقتًا للاستخدام دون اتصال

### خدمة المصادقة

يدير ملف `auth_service.dart` مصادقة المستخدم:

- التعامل مع تسجيل دخول المستخدم والتسجيل
- إدارة حالة المصادقة
- توفير معلومات المستخدم الحالي
- تنفيذ منطق تحديث الرمز المميز

### خدمة الإشعارات

يدير ملف `notification_service.dart` إشعارات الدفع:

- تهيئة مزودي الإشعارات
- التعامل مع أذونات الإشعارات
- معالجة الإشعارات الواردة
- إدارة مواضيع الإشعارات

## الاستخدام

### حقن التبعيات

يتم توفير الخدمات عادة من خلال موفري Riverpod:

```dart
// تعريف المزود
final firebaseServiceProvider = Provider<FirebaseService>((ref) {
  return FirebaseService();
});

// الوصول إلى الخدمة في عنصر واجهة المستخدم
final firebaseService = ref.watch(firebaseServiceProvider);
```

### الاستخدام المباشر

يمكن الوصول إلى بعض الخدمات مباشرة من خلال الطرق الثابتة:

```dart
// تسجيل حدث تحليلي
AnalyticsService.logEvent('product_viewed', {'product_id': 'abc123'});

// التحقق من الاتصال
final isConnected = await ConnectivityService.hasInternetConnection();
```

### تهيئة الخدمة

يتم إعداد الخدمات التي تتطلب التهيئة في طريقة main للتطبيق:

```dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  
  await FirebaseService.initialize();
  await StorageService.initialize();
  await NotificationService.initialize();
  
  runApp(const ProviderScope(child: App()));
}
```

## إنشاء خدمات جديدة

عند إنشاء خدمة جديدة:

1. تحديد مسؤولية واضحة للخدمة
2. إنشاء واجهة/فئة مجردة إذا كان من الممكن أن يكون لها تنفيذات متعددة
3. النظر فيما إذا كانت بحاجة إلى حقن أو يمكن أن تكون ثابتة
4. إضافة منطق التهيئة إذا لزم الأمر
5. توثيق واجهة برمجة التطبيقات العامة بشكل شامل
